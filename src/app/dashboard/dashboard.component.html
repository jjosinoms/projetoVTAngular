<div class="dashboard-wrapper">

  <!-- Cards -->
  <div class="cards-grid">
    <div class="card-item" *ngFor="let card of cards" (click)="navigateTo(card.route)">
      <div class="card-icon">{{ card.icon }}</div>
      <div class="card-info">
        <div class="card-title">{{ card.title }}</div>
        <div class="card-desc">{{ card.description }}</div>
      </div>
      <div class="card-hover-effect"></div>
    </div>
  </div>

  <!-- Campo de busca -->
  <div class="search-container">
    <mat-form-field appearance="fill" class="search-bar">
      <mat-label>Buscar cliente ou CNPJ</mat-label>
      <input matInput [(ngModel)]="filterText" placeholder="Digite o nome ou CNPJ">
      <button *ngIf="filterText" mat-icon-button matSuffix (click)="filterText=''">
        <mat-icon>close</mat-icon>
      </button>
      <button mat-icon-button matSuffix>
        <mat-icon>search</mat-icon>
      </button>
    </mat-form-field>
  </div>
  

  <!-- Tabela -->
  <div class="table-container mat-elevation-z8">
    <table mat-table [dataSource]="filteredClientes" class="modern-table">

      <!-- Nome -->
      <ng-container matColumnDef="nome">
        <th mat-header-cell *matHeaderCellDef>Cliente</th>
        <td mat-cell *matCellDef="let el">{{ el.nome }}</td>
      </ng-container>

      <!-- CNPJ -->
      <ng-container matColumnDef="cnpj">
        <th mat-header-cell *matHeaderCellDef>CNPJ</th>
        <td mat-cell *matCellDef="let el">{{ el.cnpj }}</td>
      </ng-container>

      <!-- Última visita -->
      <ng-container matColumnDef="ultimaVisita">
        <th mat-header-cell *matHeaderCellDef>Última Visita</th>
        <td mat-cell *matCellDef="let el">{{ getUltimaVisita(el) }}</td>
      </ng-container>

      <!-- Expandir -->
      <ng-container matColumnDef="expand">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let el">
          <mat-icon>chevron_right</mat-icon>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['nome', 'cnpj', 'ultimaVisita', 'expand']"></tr>
      <tr mat-row *matRowDef="let row; columns: ['nome', 'cnpj', 'ultimaVisita', 'expand']"
          (click)="openDetails(row)"
          class="modern-row">
      </tr>

      <tr *ngFor="let el of filteredClientes">
        <td colspan="4" *ngIf="el.expanded" class="expanded-content">
          <!-- conteúdo expandido -->
          <p class="m-0">Detalhes...</p>
        </td>
      </tr>
    </table>
  </div>
</div>